CREATE OR REPLACE PROCEDURE tmp_procedure(c_id IN NUMBER DEFAULT NULL)
AS
    v_rec sales%ROWTYPE ;
    v_cur SYS_REFCURSOR ;
    v_sql VARCHAR2(100) := 'SELECT * FROM sales WHERE 1=1 ' ;
    
BEGIN
    IF c_id IS NOT NULL THEN
        v_sql := v_sql || 'AND customer_id = :var1' ;  -- Variable for soft parsing
    END IF ;
    
    DBMS_OUTPUT.PUT_LINE(v_sql || chr(10) || '--------------') ;
    
    IF c_id IS NOT NULL THEN
        OPEN v_cur FOR v_sql USING c_id ;  -- Binding a variable
    ELSE
        OPEN v_cur FOR v_sql ;
    END IF ;
    
    LOOP
        FETCH v_cur INTO v_rec ;
        EXIT WHEN v_cur%NOTFOUND ;
        DBMS_OUTPUT.PUT_LINE('Date of sale is due to: ' || v_rec.sales_date) ;
    END LOOP ;
    
    CLOSE v_cur ;
    
EXCEPTION 
    WHEN OTHERS THEN
        DBMS_OUTPUT.PUT_LINE(SQLCODE || ':' || SQLERRM) ;
    
END ;
